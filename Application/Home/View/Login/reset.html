<!DOCTYPE html>
<html>
<head lang="en">
<meta charset="UTF-8">
<meta name="keywords " content="E快帮,E快帮ERP,旺店通,ERP,店铺管理,店铺管理ERP"/>
<title>{:C('SYSTEM_NAME')}-欢迎登录</title>
<link rel="stylesheet" type="text/css" href="__ROOT__/Public/Css/easyui.css"/>
<link rel="stylesheet" type="text/css" href="__ROOT__/Public/Css/icon.css"/>
<link rel="stylesheet" type="text/css" href="__ROOT__/Public/Css/login.css?v={$version_number}">
<link rel="icon" href="__ROOT__/Public/Image/favicon.ico"  type="image/x-icon">
<script type="text/javascript" src="__ROOT__/Public/Js/jquery.min.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/jquery.md5.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/jquery.cookie.js"></script>
<!--[if lt IE 9]>
<link rel="stylesheet" type="text/css" href="__ROOT__/Public/Css/login.2.css">
<script type="text/javascript" src="__ROOT__/Public/Js/json.2.js"></script>
<![endif]-->
<script type="text/javascript" src="__ROOT__/Public/Js/login.util.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/jquery.easyui.min.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/easyui.extends.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Js/erp.util.js?v={$version_number}"></script>
</head>
<style>
#ret-top{width: 894px;margin-left: auto;margin-right: auto;padding-top: 20px;}
#ret-logo{overflow: hidden;}
#ret-logo a:first-of-type {float: left; width: 100px; height: 30px}
#ret-logo a:nth-of-type(2) {float: left;font-family: Microsoft Yahei;font-size: 14px;font-weight: normal;font-stretch: normal;line-height: 26px;letter-spacing: 0px;color: #999999; margin-top:14px;margin-left:12px;}
#ret-logo a:nth-of-type(3) {float: right;font-family: Microsoft Yahei;font-size: 14px;font-weight: normal;font-stretch: normal;line-height: 26px;letter-spacing: 0px;color: #31ac7f;margin-top:14px;margin-right: 12px;}
/*#ret-logo>img{float:right; margin-top: 17px;cursor: pointer;width: 20px;height: 20px;}*/
#reset-content{width: 900px;height: 530px;background-color: #ffffff;box-shadow: 0px 5px 19px 1px rgba(177, 187, 184, 0.28);margin-left: auto;margin-right: auto;margin-top: 20px;}
.ret-content-top{width: 900px;height: 60px;background-image: linear-gradient(87deg,#2ac38a 11%,#2eb4a7 43%,#2d9db5 100%),linear-gradient(#31ac7f,#31ac7f);background-blend-mode: normal,normal;text-align: center;}
.ret-content-top span{position: relative;top:18px;width: 79px;height: 19px;font-family: Microsoft Yahei;font-size: 20px;font-weight: 300;font-stretch: normal;line-height: 26px;letter-spacing: 0px;color: #ffffff;}
.ret-cell{margin-left: auto;margin-right: auto;width: 301px;height:40px;margin-top: 30px;}
.ret-cell2 i{background-image: url("__PUBLIC__/Image/Login/login_icon_user.png");}
.ret-cell3 i{background-image: url("__PUBLIC__/Image/Login/login_icon_Cell-phonenumber.png");}
.ret-cell4 i{background-image: url("__PUBLIC__/Image/Login/login_icon_VerificationCode.png");}
.ret-login-bottom {position: relative;bottom:50px;left:0;right:0;margin:auto;}
.ret-cell3 a{position: absolute;top:1px;right: 0;border-radius: 0 6px 6px 0;width: 89px;height: 38px;border-left: solid 1px #dddddd;font-family: SourceHanSansCN-Normal;font-size: 14px;font-weight: normal;font-stretch: normal;line-height: 38px;letter-spacing: 0px;color: #31ac7f;text-align: center;}
.ret-cell3 input{padding:6px 95px 6px 45px;}
.ret-msg{display:none;position: relative;top: -41px;color:#f15151;font-family: SourceHanSansCN-Normal;font-size: 12px;font-weight: normal;font-stretch: normal;line-height: 39px;letter-spacing: 0px;left:320px;width: 309px;height: 49px;background-image: url('__PUBLIC__/Image/Login/promptbox.png');background-repeat: no-repeat;background-position: center;overflow: hidden;background-size: 309px 49px;box-sizing: border-box;padding: 5px 15px 5px 32px;word-break: break-all;white-space: nowrap;text-overflow: ellipsis;}
.ret-msg i{position: absolute;top:17px;left: 13px;background-color: white;border: none;background-image: url('__PUBLIC__/Image/Login/Close.png');background-repeat: no-repeat;background-position: center;width: 14px;height: 14px;}
</style>
<body>
<div id="ret-top">
	<div id="ret-logo">
		<a href="__ROOT__/index.php/home/login/login.html">
		<img alt="E快帮" src="__ROOT__/Public/Image/Login/login_logo_green.png" >
		</a>
		<a href="__ROOT__/index.php/home/login/login.html" >网上开店 找E快帮</a>
		<img src="__ROOT__/Public/Image/Login/login_icon_consulting.png" onclick="sendToQQ()" title="点击联系客服"/>
		<a href="{:U('Home/Login/login')}?type=logout">登录</a>
	</div>
</div>
<div id="reset-content">
	<div class="ret-content-top">
		<span>输入账号</span>
	</div>
	<div class="ret-login-form" >
		<form id="ret-login-form" method="post">
			<div class="cell ret-cell"><i class="input-icon"></i><input class="text" type="text" id="sid" name="sid" maxlength="25" placeholder="卖家账号"/><p class="ret-msg ret-msg-sid" name="卖家账号"></p></div>
			<div class="cell ret-cell ret-cell2"><i class="input-icon"></i><input class="text" type="text" id="account" name="account" maxlength="30" placeholder="用户名"/><p class="ret-msg ret-msg-account" name="用户名"></p></div>
			<div class="cell ret-cell ret-cell3 sendCode"><i class="input-icon"></i><input class="text" type="text" id="mobile_no" name="mobile_no" maxlength="30" placeholder="手机号"/><a href="javascript:void(0)" onclick="sendCode();" >获取验证码</a><p class="ret-msg ret-msg-mobile_no" name="手机号"></p></div>
			<div class="cell ret-cell ret-cell4"><i class="input-icon"></i><input class="text" type="text" id="code" name="code" maxlength="30" placeholder="验证码"/><p class="ret-msg ret-msg-code" name="验证码"></p></div>
			<div class="cell2 ret-cell ret-cell5"><a id="resetsubmit" href="javascript:void(0)" class="button" onclick="checkResetInfo();">下一步</a></div>
		</form>
	</div>
</div>
<div class="ret-login-bottom"><div class="copyright">©版权所有E快帮  服务热线:400-010-1039</div></div>
<script type="text/javascript">
$(function(){
	//检测浏览器版本
	check_navigator();
	function check_navigator(){
		var userAgent=navigator.userAgent.toLowerCase();
		var appVersion=navigator.appVersion.toLowerCase();
		var status=1;
		if (!!window.ActiveXObject || "ActiveXObject" in window){
			if(appVersion.match(/msie 8./i)=="msie 8."){
				status=0;
			}else if(appVersion.match(/msie 7./i)=="msie 7."){
				status=0;
			}else if(appVersion.match(/msie 5./i)=="msie 5."){
				status=0;
			}
		}
		if(status==0){
			alert('当前浏览器版本无法正常使用本系统，请更换谷歌浏览器！');
		}
	}
});
function sendToQQ(){
	var url = "http://wpa.qq.com/msgrd?v=3&uin=3194947699&site=qq&menu=yes";
	window.open(url);
}
function formValidate(data,del_code){
	var is_show = true;
	var is_return = true;
	del_code = del_code == undefined ? false : del_code;
	if(del_code){delete data.code;}
	for(var i in data){
		if(!$.trim(data[i])){
			$('#'+i).addClass('err');
			if(is_show){
				$('.ret-msg-'+i).css('display','block');$('.ret-msg-'+i).html('<i></i>'+$('.ret-msg-'+i).attr('name')+'不能为空');
			}
			is_show = false;is_return = false;
		}else{
			$('#'+i).removeClass('err');$('.ret-msg-'+i).css('display','none');
			$('.ret-msg-'+i).html('');
		}
	}
	if(is_show){
		if(!/^[a-zA-Z0-9_]{1,}$/.test(data.sid)){$('#sid').addClass('err');$('.ret-msg-sid').css('display','block');$('.ret-msg-sid').html('<i></i>卖家账号格式不正确！');is_return = false;}
		if(!/^[a-zA-Z0-9_]{1,}$/.test(data.account)){$('#account').addClass('err');$('.ret-msg-account').css('display','block');$('.ret-msg-account').html('<i></i>用户名格式不正确！');is_return = false;}
		if(!/^(?:13\d|15\d|18\d|17\d|14\d)-?\d{5}(\d{3}|\*{3})$/.test(data.mobile_no)){$('#mobile_no').addClass('err');$('.ret-msg-mobile_no').css('display','block');$('.ret-msg-mobile_no').html('<i></i>手机号格式不正确！');is_return = false;}
	}
	return is_return;
}
function showRetInfo(info){
	if(info.indexOf('卖家账号')>-1){$('#sid').addClass('err');$('.ret-msg-sid').html('<i></i>'+info);$('.ret-msg-sid').css('display','block');}
	else if(info.indexOf('用户')>-1){$('#account').addClass('err');$('.ret-msg-account').html('<i></i>'+info);$('.ret-msg-account').css('display','block');}
	else if(info.indexOf('手机')>-1||info.indexOf('短信')>-1){$('#mobile_no').addClass('err');$('.ret-msg-mobile_no').html('<i></i>'+info);$('.ret-msg-mobile_no').css('display','block');}
	else if(info.indexOf('验证码')>-1||info.indexOf('失败')>-1||info.indexOf('频繁')>-1){$('#code').addClass('err');$('.ret-msg-code').html('<i></i>'+info);$('.ret-msg-code').css('display','block');}
	else if(info.indexOf('未知错误')>-1){messager.alert(info);}
}
function checkResetInfo(){
	var form=$("#ret-login-form");
	var data=form.form('get');
	if(!formValidate(data)){return;}
	$.post("{:U('Home/Login/checkResetInfo')}",{data:JSON.stringify(data)},function(res){
		if(res.status==1){
			showRetInfo(res.info);return false;
		}else if(res.status==0){
			window.location.href = res.info;
		}
	});
}
function sendCode(){
	var form=$("#ret-login-form");
	var data=form.form('get');
	if(setTime.send){return;}
	if(!formValidate(data,true)){return;}
	$.post("{:U('Home/Login/sendResetCode')}",{data:JSON.stringify(data)},function(res){
		if(res.status==1){
			showRetInfo(res.info);return false;
		}else{
			setTime.send=true;
			$('.ret-msg-mobile_no').css('display','block');
			$('.ret-msg-mobile_no').html('<span style="color:green;">'+res.info+'</span>');
			setTime.init($('.sendCode a'),$('.sendCode a'));
		}
	});
}
var setTime=function(){
	return{
		node_but:null,
		node_txt:null,
		count:60,
		send:false,
		start:function(){
			if(this.count>0){
				this.count--;
				this.node_txt.text(this.count+'秒后可重发');
				var that = this;
	            setTimeout(function(){ that.start(); },1000);
			}else{
				 this.count = 60;
				 this.node_txt.text('发送验证码');
				 $('.ret-msg-mobile_no').html('');
				 $('.ret-msg-mobile_no').css('display','none');
				 //this.node_but.linkbutton('enable');
				 this.node_but.css('color','#31ac7f');
				 this.send = false;
			}
		},
		init:function(but,txt){
			this.node_but=but;
			this.node_txt=txt;
			//this.node_but.linkbutton('enable');
			this.node_but.css('color','#f15151');
			this.start();
		}
	};
}();
</script>
</body>
</html>